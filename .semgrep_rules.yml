rules:
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
#  ğŸš¨ 1. Ğ‘Ğ»Ğ¾ĞºĞ¸Ñ€ÑƒÑÑ‰Ğ°Ñ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ° (SSRâ€¯F) â€” ÑƒĞ¶Ğµ ĞµÑÑ‚ÑŒ Ğ²Ñ‹ÑˆĞµ
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  - id: ssrf-node
    pattern-either:
      - pattern: axios("http://$URL")
      - pattern: fetch("http://$URL")
      - pattern: request.get($URL)
    message: "Ğ’Ğ¾Ğ·Ğ¼Ğ¾Ğ¶ĞµĞ½ SSRF â€“ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ Ñ„Ğ¾Ñ€Ğ¼Ğ¸Ñ€ÑƒĞµÑ‚ URL Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ°"
    languages: [js, ts]
    severity: ERROR

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
#  â„¹ï¸ 2. Serverâ€‘Side Template Injection (Pug/EJS/Handlebars)
#       (Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ ĞµÑĞ»Ğ¸ template Ğ¿Ñ€Ğ¸Ñ…Ğ¾Ğ´Ğ¸Ñ‚ Ğ¸Ğ· req/query/body)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  - id: ssti-node
    pattern-either:
      # Pug
      - pattern: |
          const $tpl = $REQ.$_ ;
          pug.compile($tpl)($ANY*)
      # EJS
      - pattern: |
          const $tpl = $REQ.$_ ;
          ejs.render($tpl,$ANY*)
      # Handlebars
      - pattern: |
          const $tpl = $REQ.$_ ;
          handlebars.compile($tpl)($ANY*)
    message: "SSTI: ĞºĞ¾Ğ¼Ğ¿Ğ¸Ğ»Ğ¸Ñ€ÑƒĞµÑ‚ÑÑ ÑˆĞ°Ğ±Ğ»Ğ¾Ğ½, Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ½Ñ‹Ğ¹ Ğ¾Ñ‚ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ"
    languages: [js, ts]
    severity: INFO

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
#  â„¹ï¸ 3. DOMâ€‘XSS (Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ¸Ğ»Ğ¸ â€” Ğ»Ğ¾Ğ²Ğ¸Ğ¼ Ğ¿Ñ€ÑĞ¼ÑƒÑ Ğ²ÑÑ‚Ğ°Ğ²ĞºÑƒ Ğ²Ğ¾ Â«Ğ²Ğ·Ñ€Ñ‹Ğ²Ğ¾Ğ¾Ğ¿Ğ°ÑĞ½Ñ‹ĞµÂ» API)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  - id: dom-xss-assign
    patterns:
      - pattern: $EL.innerHTML = $USR
      - pattern-not: $EL.innerHTML = DOMPurify.sanitize($USR)
    message: "DOMâ€‘XSS: Ğ¿Ñ€Ğ¸ÑĞ²Ğ¾ĞµĞ½Ğ¸Ğµ innerHTML Ğ¸Ğ· Ğ½ĞµĞ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞµĞ½Ğ½Ñ‹Ñ… Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…"
    languages: [js, ts]
    severity: INFO

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
#  â„¹ï¸ 4. NULLâ€‘byte path trick (NodeÂ FSÂ /Â path APIs)
#       Ğ»Ğ¾Ğ²Ğ¸Ğ¼ '\0' Ğ² Ğ¿ÑƒÑ‚Ğ¸, ĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğ¹ Ğ¿Ñ€Ğ¸ÑˆÑ‘Ğ» Ğ¾Ñ‚ ÑĞ·ĞµÑ€Ğ°
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  - id: null-byte-path
    pattern: |
      fs.$FUNC($PATH, ...)
    metavariable-pattern:
      metavariable: $PATH
      pattern: $REQ.$_
    pattern-either:
      - pattern-inside: |
          if ($PATH.includes("\0")) { ... }    # ÑƒĞ¶Ğµ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ÑÑÑ‚ â†”Â Ğ¸Ğ³Ğ½Ğ¾Ñ€Ğ¸Ñ€ÑƒĞµĞ¼
    pattern-not-inside: |
      if ($PATH.includes("\0")) { ... }
    message: "Nullâ€‘byte Ğ² Ğ¿ÑƒÑ‚Ğ¸ Ğ¸Ğ· Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒÑĞºĞ¾Ğ³Ğ¾ Ğ²Ğ²Ğ¾Ğ´Ğ° (Ğ¾Ğ±Ñ…Ğ¾Ğ´ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€Ğ¾ĞºÂ FS)"
    languages: [js, ts]
    severity: INFO

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
#  â„¹ï¸ 5. BrokenÂ AccessÂ Control: Ğ¾Ñ‚ĞºÑ€Ñ‹Ñ‚Ñ‹Ğ¹ /adminâ€‘Ñ€Ğ¾ÑƒÑ‚ Ğ±ĞµĞ· middleâ€‘ware
#       (Ğ½ĞµÑ‚ verify/auth/check/token Ğ¸ ĞµÑÑ‚ÑŒ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ¾Ğ´Ğ¸Ğ½ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‡Ğ¸Ğº)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  - id: bac-open-admin-route
    patterns:
      - pattern: |
          app.get("/admin", $HANDLER)
      - pattern-not: |
          app.get("/admin", $AUTH, $HANDLER)
    message: "Brokenâ€¯Accessâ€¯Control: /admin Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ĞµĞ½ Ğ±ĞµĞ· Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¸ Ğ°Ğ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸"
    languages: [js, ts]
    severity: INFO
