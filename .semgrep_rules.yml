rules:
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
#  ğŸš¨ 1. Ğ‘Ğ»Ğ¾ĞºĞ¸Ñ€ÑƒÑÑ‰Ğ°Ñ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ° (SSRâ€¯F) â€” ÑƒĞ¶Ğµ ĞµÑÑ‚ÑŒ Ğ²Ñ‹ÑˆĞµ
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  - id: ssrf-node
    pattern-either:
      - pattern: axios("http://$URL")
      - pattern: fetch("http://$URL")
      - pattern: request.get($URL)
    message: "Ğ’Ğ¾Ğ·Ğ¼Ğ¾Ğ¶ĞµĞ½ SSRF â€“ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ Ñ„Ğ¾Ñ€Ğ¼Ğ¸Ñ€ÑƒĞµÑ‚ URL Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ°"
    languages: [js, ts]
    severity: ERROR

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
#  â„¹ï¸ 2. Serverâ€‘Side Template Injection (Pug/EJS/Handlebars)
#       (Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ ĞµÑĞ»Ğ¸ template Ğ¿Ñ€Ğ¸Ñ…Ğ¾Ğ´Ğ¸Ñ‚ Ğ¸Ğ· req/query/body)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  - id: ssti-node
    patterns:
      - pattern: |
          const $TPL = $REQ.$_;
      - pattern: |
          ejs.render($TPL, ...)
    message: "SSTI: ÑˆĞ°Ğ±Ğ»Ğ¾Ğ½ Ğ´Ğ»Ñ EJS Ñ„Ğ¾Ñ€Ğ¼Ğ¸Ñ€ÑƒĞµÑ‚ÑÑ Ğ½Ğ°Ğ¿Ñ€ÑĞ¼ÑƒÑ Ğ¸Ğ· Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ°"
    languages: [js, ts]
    severity: INFO


# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
#  â„¹ï¸ 3. DOMâ€‘XSS (Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ¸Ğ»Ğ¸ â€” Ğ»Ğ¾Ğ²Ğ¸Ğ¼ Ğ¿Ñ€ÑĞ¼ÑƒÑ Ğ²ÑÑ‚Ğ°Ğ²ĞºÑƒ Ğ²Ğ¾ Â«Ğ²Ğ·Ñ€Ñ‹Ğ²Ğ¾Ğ¾Ğ¿Ğ°ÑĞ½Ñ‹ĞµÂ» API)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  - id: dom-xss-assign
    patterns:
      - pattern: $EL.innerHTML = $USR
      - pattern-not: $EL.innerHTML = DOMPurify.sanitize($USR)
    message: "DOMâ€‘XSS: Ğ¿Ñ€Ğ¸ÑĞ²Ğ¾ĞµĞ½Ğ¸Ğµ innerHTML Ğ¸Ğ· Ğ½ĞµĞ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞµĞ½Ğ½Ñ‹Ñ… Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…"
    languages: [js, ts]
    severity: INFO

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
#  â„¹ï¸ 4. NULLâ€‘byte path trick (NodeÂ FSÂ /Â path APIs)
#       Ğ»Ğ¾Ğ²Ğ¸Ğ¼ '\0' Ğ² Ğ¿ÑƒÑ‚Ğ¸, ĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğ¹ Ğ¿Ñ€Ğ¸ÑˆÑ‘Ğ» Ğ¾Ñ‚ ÑĞ·ĞµÑ€Ğ°
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  - id: null-byte-path
    patterns:                             # Ğ¾Ğ´Ğ¸Ğ½ Ğ¼Ğ°ÑÑĞ¸Ğ² patterns
      # â‘  ÑĞ°Ğ¼Ğ° Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ñ fs.*
      - pattern: |
          fs.$FUNC($PATH, ...)
      # â‘¡ $PATH Ğ¿Ñ€Ğ¸ÑˆÑ‘Ğ» Ğ¸Ğ· Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ° (req.* / query / params / body)
      - metavariable-pattern:
          metavariable: $PATH
          pattern: $REQ.$_
      # â‘¢ â€¦Ğ¸ Ğ¿Ñ€Ğ¸ ÑÑ‚Ğ¾Ğ¼ Ñ€Ğ°Ğ½ÑŒÑˆĞµ Ğ½Ğµ Ğ´ĞµĞ»Ğ°Ğ»Ğ¸ Ğ·Ğ°Ñ‰Ğ¸Ñ‚Ğ½ÑƒÑ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºÑƒ includes('\0')
      - pattern-not-inside: |
          if ($PATH.includes("\0")) { ... }
    message: "Nullâ€‘byte Ğ² Ğ¿ÑƒÑ‚Ğ¸ Ğ¸Ğ· Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒÑĞºĞ¾Ğ³Ğ¾ Ğ²Ğ²Ğ¾Ğ´Ğ° (Ğ¾Ğ±Ñ…Ğ¾Ğ´ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€Ğ¾ĞºÂ FS)"
    languages: [js, ts]
    severity: INFO

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
#  â„¹ï¸ 5. Broken Access Control â€” Ğ¾Ñ‚ĞºÑ€Ñ‹Ñ‚Ñ‹Ğ¹ /admin Ğ±ĞµĞ· authâ€‘middleware
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  - id: bac-open-admin-route
    patterns:
      # ÑĞ°Ğ¼ ÑƒÑĞ·Ğ²Ğ¸Ğ¼Ñ‹Ğ¹ Ğ¼Ğ°Ñ€ÑˆÑ€ÑƒÑ‚
      - pattern: |
          app.get("/admin", $HANDLER)
      # Ğ¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ğ²ÑƒĞµÑ‚ Ğ¿Ñ€Ğ¾Ğ¼ĞµĞ¶ÑƒÑ‚Ğ¾Ñ‡Ğ½Ğ°Ñ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ° (â€˜authâ€™, â€˜verifyâ€™, â€˜tokenâ€™, â€¦)
      - pattern-not-inside: |
          app.get("/admin", $AUTH, $HANDLER)
    message: "Brokenâ€¯Accessâ€¯Control: /admin Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ĞµĞ½ Ğ±ĞµĞ· Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¸ Ğ°Ğ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸"
    languages: [js, ts]
    severity: INFO
